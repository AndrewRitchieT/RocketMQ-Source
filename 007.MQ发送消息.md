



## 同步发送模式



同步，意思就是你通过这行代码发送消息到MQ去，SendResult sendResult = producer.send(msg)，然后你会卡在这里，代码不能往下走了



你要一直等待MQ返回一个结果给你，你拿到了SendResult之后，接着你的代码才会继续往下走。



这个就是所谓的同步发送模式。







## 异步发送模式



异步发送，异步的意思就是你发送消息的时候不会卡在上面那行代码等待MQ返回结果给你，会继续执行下面的别的代码，当MQ返回结果给你的时候，会回调你的函数！







## 单向发送模式



个sendOneway的意思，就是你发送一个消息给MQ，然后代码就往下走了，根本不会关注MQ有没有返回结果给你，你也不需要MQ返回的结果，无论发送的消息是成功还是失败，都不关你的事。 









## Push消费模式

Broker主动推送消息给消费者





## Pull消费模式

Broker不会主动推送消息给Consumer，而是消费者主动发送请求到Broker去拉取消息过来。 











## MessageQueue



MessageQueue是一个数据分片的机制

有的MessageQueue的数据多，有的数据少，这个要根据你的消息写入MessageQueue的策略来定。

通过MessageQueue将一个Topic的数据拆分为了很多个数据分片，然后在每个Broker机器上都存储一些MessageQueue。

生产者从NameServer中就会知道，一个Topic有几个MessageQueue，哪些MessageQueue在哪台Broker机器上，哪些MesssageQueue在另外一台Broker机器上。

让一个Topic中的数据分散在多个MessageQueue中，进而分散在多个Broker机器上

Producer中开启一个开关  sendLatencyFaultEnable

 一旦打开了这个开关，那么他会有一个自动容错机制，比如如果某次访问一个Broker发现网络延迟有500ms，然后还无法访问，那么就会自动回避访问这个Broker一段时间，比如接下来3000ms内，就不会访问这个Broker了。

避免一个Broker故障之后，短时间内生产者频繁的发送消息到这个故障的Broker上去，出现较多次数的异常。而是在一个Broker故障之后，自动回避一段时间不要访问这个Broker，过段时间再去访问他。

